name: Vector Nayan V44 â€“ Court Grade CI

on:
  workflow_dispatch:

jobs:
  kernel-ci:
    runs-on: ubuntu-latest
    timeout-minutes: 60

    steps:
    - name: Checkout config repo
      uses: actions/checkout@v4

    - name: Clone Kernel
      run: |
        git clone https://${{ secrets.Kernal_TOKEN }}@github.com/nayan9572/VECTOR_NAYAN_V44_KERNAL.git kernel

    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.10"

    - name: Install dependencies
      run: |
        pip install --upgrade pip
        pip install numpy pandas scipy matplotlib networkx seaborn scikit-learn tqdm

    - name: Create colab stub
      run: |
        mkdir -p google
        echo "" > google/__init__.py
        cat <<EOF > google/colab.py
        class files:
            @staticmethod
            def download(x): print("CI mode")
        EOF

    - name: Run CI Kernel
      working-directory: kernel
      run: |
        python -u ci_runner.py

    - name: Verify CSV existence
      run: |
        if [ ! -f kernel/Vector_Nayan_V44_Cycle_By_Cycle.csv ]; then
          echo "CSV missing"
          exit 1
        fi

    - name: Upload CSV
      uses: actions/upload-artifact@v4
      with:
        name: Vector_Nayan_V44_CSV
        path: kernel/Vector_Nayan_V44_Cycle_By_Cycle.csv
